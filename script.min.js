let API_KEY = "19a14bc5d901149be0309256757968fa", BASE_URL = "https://api.themoviedb.org/3", IMAGE_BASE_URL = "https://image.tmdb.org/t/p", moviesGrid = document.getElementById("moviesGrid"), searchInput = document.getElementById("search"), searchBtn = document.getElementById("searchBtn"), categoryBtns = document.querySelectorAll(".category-btn"), modal = document.getElementById("movieModal"), modalBody = modal.querySelector(".modal-body"), closeBtn = modal.querySelector(".close-btn"), currentCategory = "popular"; async function fetchMovies(t) { try { let e; var a; e = "search" === t ? (a = searchInput.value.trim(), `${BASE_URL}/search/movie?api_key=${API_KEY}&query=` + encodeURIComponent(a)) : BASE_URL + `/movie/${t}?api_key=` + API_KEY, displayMovies((await (await fetch(e)).json()).results) } catch (e) { console.error("Error fetching movies:", e), moviesGrid.innerHTML = '<p class="error">Error loading movies. Please try again later.</p>' } } function displayMovies(e) {
    moviesGrid.innerHTML = "", e.forEach(e => {
        var t = document.createElement("div"), a = (t.className = "movie-card", t.onclick = () => showMovieDetails(e.id), e.poster_path ? IMAGE_BASE_URL + "/w500" + e.poster_path : "https://via.placeholder.com/500x750?text=No+Poster+Available"); t.innerHTML = `
            <img class="movie-poster" src="${a}" alt="${e.title}">
            <div class="movie-info">
                <h3 class="movie-title">${e.title}</h3>
                <div class="movie-rating">
                    <div class="rating-circle">${Math.round(10 * e.vote_average)}%</div>
                    <span>${new Date(e.release_date).getFullYear()}</span>
                </div>
            </div>
        `, moviesGrid.appendChild(t)
    })
} async function showMovieDetails(e) {
    try {
        var [t, a] = await Promise.all([fetch(BASE_URL + `/movie/${e}?api_key=` + API_KEY).then(e => e.json()), fetch(BASE_URL + `/movie/${e}/videos?api_key=` + API_KEY).then(e => e.json())]), r = a.results.find(e => "Trailer" === e.type) || a.results[0], i = t.poster_path ? IMAGE_BASE_URL + "/w500" + t.poster_path : "https://via.placeholder.com/500x750?text=No+Poster+Available"; modalBody.innerHTML = `
            <div class="movie-detail">
                <img class="detail-poster" src="${i}" alt="${t.title}">
                <div class="detail-info">
                    <h2 class="detail-title">${t.title} (${new Date(t.release_date).getFullYear()})</h2>
                    <div class="movie-rating">
                        <div class="rating-circle">${Math.round(10 * t.vote_average)}%</div>
                        <span>User Score</span>
                    </div>
                    <h3>Overview</h3>
                    <p class="detail-overview">${t.overview}</p>
                    <p><strong>Genres:</strong> ${t.genres.map(e => e.name).join(", ")}</p>
                    <p><strong>Runtime:</strong> ${t.runtime} minutes</p>
                </div>
            </div>
            ${r ? `
                <div class="trailer-container">
                    <h3>Trailer</h3>
                    <iframe
                        src="https://www.youtube.com/embed/${r.key}"
                        frameborder="0"
                        allowfullscreen
                    ></iframe>
                </div>
            `: ""}
        `, modal.style.display = "block"
    } catch (e) { console.error("Error fetching movie details:", e) }
} function handleSearch() { searchInput.value.trim() && (currentCategory = "search", categoryBtns.forEach(e => e.classList.remove("active")), fetchMovies("search")) } document.addEventListener("DOMContentLoaded", () => { fetchMovies(currentCategory) }), searchBtn.addEventListener("click", handleSearch), searchInput.addEventListener("keypress", e => { "Enter" === e.key && handleSearch() }), categoryBtns.forEach(t => { t.addEventListener("click", () => { var e = t.dataset.category; currentCategory = e, categoryBtns.forEach(e => e.classList.remove("active")), t.classList.add("active"), fetchMovies(e) }) }), closeBtn.addEventListener("click", () => { modal.style.display = "none" }), window.addEventListener("click", e => { e.target === modal && (modal.style.display = "none") });